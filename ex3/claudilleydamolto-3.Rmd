---
output:
  pdf_document: default
  html_document: default
---
```{r}
# Claudi Lleyda Molt√≥
# 1462908
# ----------
#setwd("~/UAB/MSE/Data-visualization/Exercises/intro-to-R/ex3")
#ls()

# ----------
# https://developer.tmb.cat/data/parades
parades <- read.csv("parades.csv", header = TRUE, sep = ",", quote = "\"")

parades$NOM_TIPUS_PARADA <- as.factor(parades$NOM_TIPUS_PARADA)
parades$TIPIFICACIO_PARADA <- as.factor(parades$TIPIFICACIO_PARADA)
parades$ID_POBLACIO <- as.factor(parades$ID_POBLACIO)
parades$ID_DISTRICTE <- as.factor(parades$ID_DISTRICTE)

pairs(parades[,c("ID_PARADA", "CODI_PARADA", "CODI_INTERC", "LON", "LAT")])

par(xpd = T, mar = par()$mar + c(0,0,0,6))
plot(parades$LAT, parades$LON, col = parades$ID_DISTRICTE, pch = as.numeric(parades$TIPIFICACIO_PARADA))
legend("right", inset = c(-0.45, 0), legend = levels(as.factor(parades$NOM_DISTRICTE))[2:11], col = as.numeric(parades$ID_DISTRICTE), pch = 15)
legend("topleft", legend = levels(parades$TIPIFICACIO_PARADA), col = 1, pch = 1:length(levels(parades$TIPIFICACIO_PARADA)))
par(mar = c(5, 4, 4, 2))

library(lattice)
xyplot(parades$LAT~parades$LON|parades$ID_DISTRICTE+parades$TIPIFICACIO_PARADA)
```

```{r}
sample(seq(0, 2, length.out = 201), 100, replace = FALSE)
dt(seq(-1, 1, length.out = 21), df = 13)
qt(0.01, df = 9)

qnorm(0.8, mean = 100, sd = 15)
qnorm(0.9, mean = 100, sd = 15)
1 - pnorm(142, mean = 100, sd = 15)

set.seed(0)
rnorm(20, mean = 100, sd = 15)

set.seed(1462908)
rnorm(20, mean = 100, sd = 15)
```

```{r}
x <- 1:20
w <- 1 + (sqrt(x) / 2)

set.seed(0)
dummy <- data.frame(x = x, y = x + (rnorm(x) * w))

jpeg("claudilleydamolto-3-3-d.jpeg")
par(mfrow = c(1, 2))
hist(dummy$y, xlab = "y", ylab = "Frequency", main = "Histogram of y")
boxplot(dummy$y, xlab="y", main = "Boxplot of y")
dev.off()
par(mfrow = c (1 ,1))
```
![Plot saved to claudilleydamolto-3-3-d.jpeg:](claudilleydamolto-3-3-d.jpeg)
```{r}
plot(dummy$x ~ dummy$y, main = "Plot of x vs y", xlab = "x", ylab = "y")

fm <- lm(x ~ y, data = dummy)
abline(coef(fm), col = "blue")

resids <- resid(fm)
qqnorm(resids)
qqline(resids)
```

```{r}
coplot(airquality$Ozone ~ airquality$Solar.R | airquality$Temp * airquality$Wind, number = c(3, 3), overlap = 0)
```

```{r}
hist(airquality$Wind, prob = TRUE)
lines(density(airquality$Wind), col = "blue")
```

```{r}
locate.f <- function(int, vector)
{
  return(int %in% vector)
}

unique.f <- function(vector)
{
  return(unique(vector))
}
```

```{r}
toNA <- function(v1, v.na) {
    for(value in v.na) {
        v1[v1 == value] <- NA
    }
    return(v1)
}

rincome <- scan("data/rincome.txt" , character(), sep = "\n", skipNul = TRUE)
rincome <- toNA(rincome, c("Don't know", "No answer", "Not applicable", "Refused"))

big.values <- function(vec, tresh) {
    vec[vec > tresh] <- NA
    return(vec)
}

big.values <- function(vec, tresh, greater = TRUE) {
    if(greater) {
        vec[vec > tresh] <- NA
        return(vec)
    } else {
        vec[vec < tresh] <- NA
        return(vec)
    }
}

airquality$Solar.R <- big.values(airquality$Solar.R, 320)
```
